# Урок 23. Воздушное пианино

## Теория  

Обычное пианино работает при нажатии клавиш, которые ударяют по струнам или включают электронные звуки.  
**Воздушное пианино** — это устройство, где «клавишами» являются невидимые зоны, а звук возникает при приближении руки.  

Принцип работы:  
- Для обнаружения положения руки используются **ультразвуковые датчики** или **ИК-датчики расстояния**.  
- Каждая зона соответствует ноте.  
- Arduino включает пьезо-динамик и воспроизводит соответствующую частоту.  

Таким образом, мы можем играть «музыку в воздухе», не касаясь никаких кнопок.  

---

## Интересные факты  

- Первый электронный инструмент без касания — **Theremin**, изобретённый в 1920-х годах. Управление в нём тоже основано на движениях рук.  
- Воздушные пианино часто используют в STEM-курсах, чтобы показать сочетание физики звука и датчиков.  
- Подобные технологии применяются в **бесконтактных интерфейсах** — от жестового управления телевизорами до VR.  

---

## Практика  

### Материалы  

- Arduino Uno (или совместимая).  
- Пьезо-динамик.  
- Несколько ультразвуковых датчиков HC-SR04 (или 1 датчик и кнопка для переключения).  
- Макетная плата, провода.  

### Подключение (для 2 нот, 2 датчика)  

- **HC-SR04 №1**: TRIG → D3, ECHO → D4.  
- **HC-SR04 №2**: TRIG → D5, ECHO → D6.  
- **Пьезо**: D9 → динамик → GND.  

---

## Программный код (базовая версия с 2 датчиками)

```cpp
// Урок 23: Воздушное пианино
// 2 ультразвуковых датчика = 2 ноты (до, ре)

#include <NewPing.h>

#define TRIG1 3
#define ECHO1 4
#define TRIG2 5
#define ECHO2 6
#define MAX_DISTANCE 30  // макс. расстояние 30 см

NewPing sonar1(TRIG1, ECHO1, MAX_DISTANCE);
NewPing sonar2(TRIG2, ECHO2, MAX_DISTANCE);

int buzzerPin = 9;

void setup() {
  pinMode(buzzerPin, OUTPUT);
  Serial.begin(9600);
}

void loop() {
  delay(50);

  int dist1 = sonar1.ping_cm();
  int dist2 = sonar2.ping_cm();

  if (dist1 > 0 && dist1 < 20) {
    tone(buzz

```

Программный код (расширенный вариант с 4 нотами на 2 датчиках)

```cpp
// Воздушное пианино с 4 нотами
// В зависимости от расстояния руки до датчика

#include <NewPing.h>

#define TRIG1 3
#define ECHO1 4
#define TRIG2 5
#define ECHO2 6
#define MAX_DISTANCE 40

NewPing sonar1(TRIG1, ECHO1, MAX_DISTANCE);
NewPing sonar2(TRIG2, ECHO2, MAX_DISTANCE);

int buzzerPin = 9;

void setup() {
  pinMode(buzzerPin, OUTPUT);
  Serial.begin(9600);
}

void loop() {
  delay(50);

  int d1 = sonar1.ping_cm();
  int d2 = sonar2.ping_cm();

  if (d1 > 0 && d1 < 10) {
    tone(buzzerPin, 262); // До
    Serial.println("До");
  } else if (d1 >= 10 && d1 < 20) {
    tone(buzzerPin, 294); // Ре
    Serial.println("Ре");
  } else if (d2 > 0 && d2 < 10) {
    tone(buzzerPin, 330); // Ми
    Serial.println("Ми");
  } else if (d2 >= 10 && d2 < 20) {
    tone(buzzerPin, 349); // Фа
    Serial.println("Фа");
  } else {
    noTone(buzzerPin);
  }
}

```

Эксперименты

Измените частоты (tone) для получения других нот (Соль, Ля, Си).
Используйте один датчик и несколько диапазонов расстояний (например, ближе 10 см — До, от 10 до 20 см — Ре и т.д.).
Сделайте «режим пианино»: нота звучит только, пока рука находится в зоне, и останавливается при уходе.
Добавьте кнопку «переключения октавы» — для смены высоты нот.
Подключите RGB-светодиод, который будет менять цвет в зависимости от ноты.

Задание для самостоятельной работы

Нарисуйте схему подключения 2 ультразвуковых датчиков и пьезо.
Составьте таблицу: расстояние → нота.
Добавьте 3-й датчик и реализуйте минимум 6 нот.
Сделайте проект «Воздушная мелодия»: Arduino играет записанную мелодию, а игрок должен повторить, перемещая руки.
Реализуйте «светомузыку»: при каждой ноте загорается соответствующий цвет на RGB-светодиоде.
