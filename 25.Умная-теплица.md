# Урок 25. Умная теплица

## Теория  

Умная теплица — это автоматизированная система, которая помогает растениям расти, поддерживая оптимальные условия: свет, влажность, температуру.  
С помощью Arduino можно создать модель теплицы, где датчики будут следить за окружающей средой, а исполнительные устройства управлять освещением, поливом и вентиляцией.  

Основные компоненты умной теплицы:  
1. **Датчики**: температура, влажность почвы, освещённость.  
2. **Исполнительные устройства**: вентилятор, насос, лампа.  
3. **Контроллер** (Arduino), который принимает решения.  

---

## Интересные факты  

- Первые теплицы появились ещё в Древнем Риме для выращивания огурцов круглый год.  
- Современные промышленные теплицы используют системы на базе IoT и контролируются через смартфон.  
- В Голландии теплицы занимают около **10 000 гектаров** и являются важной частью экспорта овощей и цветов.  
- Автоматизация теплиц позволяет экономить до 40% воды при поливе.  

---

## Практика  

### Материалы  

- Arduino Uno (или совместимая).  
- Датчик температуры и влажности (DHT11 или DHT22).  
- Датчик влажности почвы.  
- Фоторезистор (LDR).  
- Реле (или транзисторы) для управления лампой, вентилятором и насосом.  
- Светодиоды (имитация лампы/насоса/вентилятора).  
- Провода, макетная плата.  

### Подключение  

1. **DHT11** → VCC 5V, GND, DATA → D2.  
2. **Датчик влажности почвы** → A0.  
3. **Фоторезистор** → один вывод к 5V, второй → A1 и через резистор 10 кОм на GND.  
4. **Реле/светодиоды**: лампа → D8, насос → D9, вентилятор → D10.  

---

## Программный код (базовая версия умной теплицы)

```cpp
// Урок 25: Умная теплица
// Контроль света, влажности почвы и температуры

#include "DHT.h"

#define DHTPIN 2
#define DHTTYPE DHT11

DHT dht(DHTPIN, DHTTYPE);

int soilPin = A0;
int lightPin = A1;

int lampPin = 8;
int pumpPin = 9;
int fanPin = 10;

void setup() {
  Serial.begin(9600);
  dht.begin();

  pinMode(lampPin, OUTPUT);
  pinMode(pumpPin, OUTPUT);
  pinMode(fanPin, OUTPUT);

  digitalWrite(lampPin, LOW);
  digitalWrite(pumpPin, LOW);
  digitalWrite(fanPin, LOW);

  Serial.println("Система умной теплицы запущена!");
}

void loop() {
  // Считывание датчиков
  float h = dht.readHumidity();
  float t = dht.readTemperature();
  int soil = analogRead(soilPin);
  int light = analogRead(lightPin);

  Serial.print("Темп: "); Serial.print(t);
  Serial.print(" C | Влажн: "); Serial.print(h);
  Serial.print(" % | Почва: "); Serial.print(soil);
  Serial.print(" | Свет: "); Serial.println(light);

  // Управление лампой
  if (light < 400) {
    digitalWrite(lampPin, HIGH);
  } else {
    digitalWrite(lampPin, LOW);
  }

  // Управление насосом
  if (soil < 500) {
    digitalWrite(pumpPin, HIGH);
  } else {
    digitalWrite(pumpPin, LOW);
  }

  // Управление вентилятором
  if (t > 28) {
    digitalWrite(fanPin, HIGH);
  } else {
    digitalWrite(fanPin, LOW);
  }

  delay(2000);
}

```

Эксперименты

Измените пороговые значения (например, включение вентилятора при 25 °C).
Добавьте «ночной режим»: ночью лампа не включается, даже если темно.
Реализуйте «умный полив»: насос включается только на несколько секунд, а затем выключается, чтобы не перелить.
Подключите второй датчик температуры и сделайте контроль «внутри» и «снаружи» теплицы.
Используйте OLED или LCD-дисплей для отображения параметров в реальном времени.

Задание для самостоятельной работы

Нарисуйте схему подключения датчиков и исполнительных устройств.
Составьте таблицу: температура, влажность почвы, свет → действие системы.
Добавьте кнопку «ручной режим», чтобы включать насос или лампу вручную.
Сделайте «аварийный сигнал»: при слишком высокой температуре (>40 °C) звучит зуммер.
Если есть модуль Wi-Fi (ESP8266), реализуйте отправку данных на смартфон или в облако.
